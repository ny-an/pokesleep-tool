import{e as ue,i as Z,t as ee,g as ce,a as me,p as N,b as Se,f as ke,P as se,c as ve,l as Be,d as be,h as we}from"./api-data-BXi2R70q.js";class k{value;static allNatureNames=["Bashful","Hardy","Docile","Quirky","Serious","Bold","Impish","Lax","Relaxed","Timid","Hasty","Jolly","Naive","Lonely","Adamant","Naughty","Brave","Calm","Gentle","Careful","Sassy","Modest","Mild","Rash","Quiet"];static allNaturesCache=[];static neautralNatures=["Bashful","Hardy","Docile","Quirky","Serious"];static energyRecoveryUpNatures=["Bold","Impish","Lax","Relaxed"];static expGainsUpNatures=["Timid","Hasty","Jolly","Naive"];static speedOfHelpUpNatures=["Lonely","Adamant","Naughty","Brave"];static mainSkillChanceUpNatures=["Calm","Gentle","Careful","Sassy"];static ingredientFindingUpNatures=["Modest","Mild","Rash","Quiet"];static energyRecoveryDownNatures=["Hasty","Lonely","Gentle","Mild"];static expGainsDownNatures=["Relaxed","Brave","Sassy","Quiet"];static speedOfHelpDownNatures=["Bold","Timid","Calm","Modest"];static mainSkillChanceDownNatures=["Lax","Naive","Naughty","Rash"];static ingredientFindingDownNatures=["Impish","Jolly","Adamant","Careful"];static ampedNatures=["Hardy","Docile","Quirky","Lax","Impish","Hasty","Naive","Jolly","Brave","Naughty","Adamant","Sassy","Rash"];static lowKeyNatures=["Bashful","Serious","Relaxed","Bold","Timid","Lonely","Gentle","Calm","Careful","Mild","Quiet","Modest"];constructor(e){if(!k.allNatureNames.includes(e))throw new Error(`Invalid nature specified: ${e}`);this.value=e}get name(){return this.value}get energyRecoveryFactor(){return this.isEnergyRecoveryUp?1.2:this.isEnergyRecoveryDown?.88:1}get speedOfHelpFactor(){return this.isSpeedOfHelpUp?.9:this.isSpeedOfHelpDown?1.075:1}get mainSkillChanceFactor(){return this.isMainSkillChanceUp?1.2:this.isMainSkillChanceDown?.8:1}get ingredientFindingFactor(){return this.isIngredientFindingUp?1.2:this.isIngredientFindingDown?.8:1}get expGainsFactor(){return this.isExpGainsUp?1:this.isExpGainsDown?-1:0}get upEffect(){return this.isEnergyRecoveryUp?"Energy recovery":this.isExpGainsUp?"EXP gains":this.isIngredientFindingUp?"Ingredient finding":this.isMainSkillChanceUp?"Main skill chance":this.isSpeedOfHelpUp?"Speed of help":"No effect"}get downEffect(){return this.isEnergyRecoveryDown?"Energy recovery":this.isExpGainsDown?"EXP gains":this.isIngredientFindingDown?"Ingredient finding":this.isMainSkillChanceDown?"Main skill chance":this.isSpeedOfHelpDown?"Speed of help":"No effect"}get isNeautral(){return k.neautralNatures.includes(this.value)}get isEnergyRecoveryUp(){return k.energyRecoveryUpNatures.includes(this.value)}get isEnergyRecoveryDown(){return k.energyRecoveryDownNatures.includes(this.value)}get isSpeedOfHelpUp(){return k.speedOfHelpUpNatures.includes(this.value)}get isSpeedOfHelpDown(){return k.speedOfHelpDownNatures.includes(this.value)}get isMainSkillChanceUp(){return k.mainSkillChanceUpNatures.includes(this.value)}get isMainSkillChanceDown(){return k.mainSkillChanceDownNatures.includes(this.value)}get isIngredientFindingUp(){return k.ingredientFindingUpNatures.includes(this.value)}get isIngredientFindingDown(){return k.ingredientFindingDownNatures.includes(this.value)}get isExpGainsUp(){return k.expGainsUpNatures.includes(this.value)}get isExpGainsDown(){return k.expGainsDownNatures.includes(this.value)}get isAmped(){return k.ampedNatures.includes(this.value)}get isLowKey(){return k.lowKeyNatures.includes(this.value)}static get allNatures(){return k.allNaturesCache.length===0&&(k.allNaturesCache=k.allNatureNames.map(e=>new k(e))),[...k.allNaturesCache]}}class Ce{_iv;_wakeMax;constructor(e){this._iv=e,this._wakeMax=e.activeSubSkills.some(t=>t.name==="Energy Recovery Bonus")?105:100}calculate(e,t=ue,i=!1){if(e.period<0)return{sleepTime:0,events:[],efficiencies:[],canBeFullInventory:!1,timeToFullInventory:-1,skillProbabilityAfterWakeup:{once:0,twice:0},carryLimit:Math.ceil(this._iv.carryLimit*(e.isGoodCampTicketSet?1.2:1)),skillRatio:0,helpCount:{awake:0,asleepNotFull:0,asleepFull:0},averageEfficiency:{total:0,awake:0,asleep:0}};const n=e.sleepScore*510/100,o=this._iv.nature.energyRecoveryFactor,s=Math.min(this._wakeMax,Math.round(n/510*100)*o*(1+.14*e.recoveryBonusCount)),u=e.e4eEnergy*o,l=1440-n;let h,c;if(e.isEnergyAlwaysFull)h=[{minutes:0,type:"wake",energyBefore:100,energyAfter:100,isSnacking:!1,isInPeriod:!0},{minutes:l,type:"sleep",energyBefore:100,energyAfter:100,isSnacking:!1,isInPeriod:!0},{minutes:1440,type:"wake",energyBefore:100,energyAfter:100,isSnacking:!1,isInPeriod:!0}],c=[{start:0,end:l,isAwake:!0,efficiency:2.222,isSnacking:!1,isInPeriod:!0},{start:l,end:1440,isAwake:!1,efficiency:2.222,isSnacking:!1,isInPeriod:!0}];else{h=this.createEvents(e.e4eCount,l),this.calculateEnergyForEvents(h,u,s,s,t.energyFromDish);const B=h[h.length-1].energyAfter;this.calculateEnergyForEvents(h,u,s,B,t.energyFromDish),this.addEmptyEvent(h),c=this.calculateEfficiency(h,l)}e.period<24&&this.splitEventAndEfficiencyByPeriod(h,c,e);const p=this.calculateAverageEfficiency(c.filter(B=>B.isInPeriod)),f=this.calculateAverageEfficiency(c.filter(B=>B.isInPeriod&&B.isAwake)),a=this.calculateAverageEfficiency(c.filter(B=>B.isInPeriod&&!B.isAwake)),{carryLimit:v,skillRatio:S,timeToFullInventory:d,helpCount:m,skillProbabilityAfterWakeup:F}=this.calculateSneakySnacking(h,c,e,t,i),b=e.tapFrequency==="always"&&e.tapFrequencyAsleep==="none";return{sleepTime:l,events:h,efficiencies:c,canBeFullInventory:b,timeToFullInventory:d,carryLimit:v,skillRatio:S,helpCount:m,skillProbabilityAfterWakeup:F,averageEfficiency:{total:p,awake:f,asleep:a}}}createEvents(e,t){const i=[{minutes:0,type:"wake",energyBefore:-1,energyAfter:-1,isSnacking:!1,isInPeriod:!0},{minutes:120,type:"cook",energyBefore:-1,energyAfter:-1,isSnacking:!1,isInPeriod:!0},{minutes:360,type:"cook",energyBefore:-1,energyAfter:-1,isSnacking:!1,isInPeriod:!0},{minutes:720,type:"cook",energyBefore:-1,energyAfter:-1,isSnacking:!1,isInPeriod:!0}];for(let n=0;n<e;n++)i.push({minutes:Math.floor((n+1)*930/(e+1)/10)*10,type:"e4e",energyBefore:-1,energyAfter:-1,isSnacking:!1,isInPeriod:!0});return i.push({minutes:t,type:"sleep",energyBefore:-1,energyAfter:-1,isSnacking:!1,isInPeriod:!0}),i.push({minutes:1440,type:"wake",energyBefore:-1,energyAfter:-1,isSnacking:!1,isInPeriod:!0}),i.sort((n,o)=>n.minutes-o.minutes)}calculateEnergyForEvents(e,t,i,n,o){e[0].energyAfter=n;for(let s=1;s<e.length;s++){const u=e[s-1],l=e[s],h=(l.minutes-u.minutes)/10;if(l.energyBefore=Math.max(0,u.energyAfter-h),l.energyAfter=l.energyBefore,l.type==="cook")l.energyAfter+=this.getEnergyRecoveryForCook(l.energyBefore)+o;else if(l.type==="e4e")l.energyAfter=Math.min(150,l.energyAfter+t);else if(l.type==="wake")l.energyAfter=Math.min(this._wakeMax,l.energyAfter+i);else if(l.type==="sleep"){l.energyAfter=l.energyBefore;continue}else{if(l.type==="empty")continue;throw new Error(`unknown event type: ${l.type}`)}l.energyAfter=Math.ceil(l.energyAfter)}e[0].energyBefore=e[e.length-1].energyBefore}addEmptyEvent(e){for(let t=1;t<e.length;t++){const i=e[t-1],o=(e[t].minutes-i.minutes)/10;if(i.energyAfter>0&&i.energyAfter<o){const s=i.minutes+i.energyAfter*10;e.splice(t,0,{minutes:s,type:"empty",energyBefore:0,energyAfter:0,isSnacking:!1,isInPeriod:!0});continue}}}calculateEfficiency(e,t){const i=[];for(let n=1;n<e.length;n++){const o=e[n-1].energyAfter,s=e[n-1].minutes,u=e[n].minutes;let l=o,h=s;for(;;){if(l<=1){l=0;break}const c=l<=40?1:l%20===0?l-20:Math.floor(l/20)*20,p=h+(l-c)*10;if(p>u)break;i.push({start:h,end:p,efficiency:this.getEfficiencyByEnergy(l),isAwake:!0,isSnacking:!1,isInPeriod:!0}),l=c,h=p}i.push({start:h,end:u,efficiency:this.getEfficiencyByEnergy(l),isAwake:!0,isSnacking:!1,isInPeriod:!0})}for(let n=0;n<i.length-1;n++)i[n].efficiency===i[n+1].efficiency&&(i[n].end=i[n+1].end,i.splice(n+1,1),n--);for(let n=0;n<i.length;n++){if(i[n].end<=t){i[n].isAwake=!0;continue}if(i[n].start>=t){i[n].isAwake=!1;continue}const o={...i[n]};i[n].end=t,i[n].isAwake=!0,o.start=t,o.isAwake=!1,i.splice(n+1,0,o)}return i}splitEventAndEfficiencyByPeriod(e,t,i){const n=i.period*60;for(let o=0;o<e.length;o++){const s=e[o],u=e[o+1]??s;if(s.minutes<n){if(s.isInPeriod=!0,u.minutes<n)continue}else if(s.minutes>=n){s.isInPeriod=!1;continue}const l=i.isEnergyAlwaysFull?s.energyAfter:Math.max(0,s.energyAfter-(n-s.minutes)/10);e.splice(o+1,0,{minutes:n,type:"empty",energyBefore:l,energyAfter:l,isSnacking:s.isSnacking,isInPeriod:!1})}for(let o=0;o<t.length;o++){const s=t[o];if(s.start>=n){s.isInPeriod=!1;continue}if(s.end<n){s.isInPeriod=!0;continue}const u={...s};s.end=n,s.isInPeriod=!0,u.start=n,u.isInPeriod=!1,t.splice(o+1,0,u)}}calculateAverageEfficiency(e){let t=0,i=0;for(const n of e){const o=n.end-n.start;t+=n.efficiency*o,i+=o}return i===0?1:Math.round(t/i*1e3)/1e3}calculateSneakySnacking(e,t,i,n,o){if(this._iv.pokemon.frequency===0)return{carryLimit:this._iv.pokemon.carryLimit,skillRatio:0,timeToFullInventory:-1,skillProbabilityAfterWakeup:{once:0,twice:0},helpCount:{total:0,awake:0,asleepNotFull:0,asleepFull:0}};const s=i.isEnergyAlwaysFull,u=i.helpBonusCount+(this._iv.hasHelpingBonusInActiveSubSkills?1:0),l=i.isGoodCampTicketSet,h=i.tapFrequency==="none",c=i.tapFrequencyAsleep==="always",p=Z(i.fieldIndex)&&!o,f=p&&i.favoriteType.includes(this._iv.pokemon.type),a=p&&i.favoriteType[0]===this._iv.pokemon.type,v=p&&!f,S=Math.ceil(this._iv.carryLimit*(l?1.2:1)),d=new q(this._iv),m=d.getBaseFrequency(u,l,a,v),F=d.getBagUsagePerHelp(n.berry,n.ingredient,p&&f&&i.expertEffect==="ing");let b=S,B=9999,E=9999;const H=h||c?[]:t.filter(g=>!g.isAwake);for(const g of H){const y=g.end-g.start,I=m/g.efficiency,D=y*60/I,U=F*D;if(U<b){b-=U;continue}B=b/F*I/60+g.start-H[0].start,E=B+H[0].start;break}for(let g=0;g<e.length;g++){const y=e[g];if(h||y.minutes>=E){y.isSnacking=!0;continue}if(g<e.length-1&&e[g+1].minutes>E){const I=s?100:Math.max(0,y.energyAfter-(E-y.minutes)/10);e.splice(g+1,0,{minutes:E,type:"snack",energyBefore:I,energyAfter:I,isSnacking:!1,isInPeriod:y.isInPeriod})}}for(let g=0;g<t.length;g++){const y=t[g];if(h||y.start>=E){y.isSnacking=!0;continue}if(E<y.end){const I=y.end;y.end=E,t.splice(g+1,0,{start:E,end:I,efficiency:y.efficiency,isAwake:y.isAwake,isSnacking:!0,isInPeriod:y.isInPeriod})}}B>1440&&(B=-1);const z=t.filter(g=>g.isInPeriod).reduce((g,y)=>g+(y.end-y.start)*60/m*y.efficiency,0),$=t.filter(g=>g.isInPeriod&&g.isAwake).reduce((g,y)=>g+(y.end-y.start)*60/m*y.efficiency,0),_=t.filter(g=>g.isInPeriod&&!g.isAwake&&!g.isSnacking).reduce((g,y)=>g+(y.end-y.start)*60/m*y.efficiency,0),G=t.filter(g=>g.isInPeriod&&!g.isAwake&&g.isSnacking).reduce((g,y)=>g+(y.end-y.start)*60/m*y.efficiency,0),x={once:0,twice:0},P=Math.ceil(_),T=d.skillRatio*n.skillTrigger;if(P>0){const g=Math.pow(1-T,P);if(this._iv.pokemon.specialty!=="Skills"&&this._iv.pokemon.specialty!=="All")x.once=1-g;else{const y=P*T*Math.pow(1-T,P-1);x.once=y,x.twice=1-g-y}}return{carryLimit:S,skillRatio:T,timeToFullInventory:B,skillProbabilityAfterWakeup:x,helpCount:{total:z,awake:$,asleepNotFull:_,asleepFull:G}}}getEnergyRecoveryForCook(e){return e>80?1:e>60?2:e>40?3:e>20?4:5}getEfficiencyByEnergy(e){return e>80?2.222:e>60?1.923:e>40?1.724:e>1?1.515:1}}const $e=["Charge Strength S","Charge Strength M","Ingredient Magnet S","Energy for Everyone S","Charge Energy S","Energizing Cheer S","Cooking Power-Up S","Tasty Chance S","Extra Helpful S","Helper Boost","Dream Shard Magnet S","Metronome","Berry Burst","Skill Copy","Ingredient Draw S"],oe=.86,Ee=.112,Ie=.028,le=.1668;function L(r){return r==="Dream Shard Magnet S"||r==="Dream Shard Magnet S (Random)"?8:r==="Ingredient Magnet S"||r==="Ingredient Magnet S (Plus)"||r==="Charge Strength M"||r==="Charge Strength M (Bad Dreams)"||r==="Charge Strength S"||r==="Charge Strength S (Random)"||r==="Charge Strength S (Stockpile)"||r==="Extra Helpful S"||r==="Cooking Power-Up S"||r==="Cooking Power-Up S (Minus)"||r==="Metronome"||r==="Skill Copy (Transform)"||r==="Skill Copy (Mimic)"||r==="Ingredient Draw S"||r==="Ingredient Draw S (Super Luck)"||r==="Ingredient Draw S (Hyper Cutter)"?7:6}function ne(r,e,t=3){if(e!==Math.floor(e))throw new Error(`invalid skill level: ${e}`);if(e<0||e>L(r))throw new Error(`invalid main skill: ${r}, ${e}`);if(r==="Ingredient Magnet S")return[6,8,11,14,17,21,24][e-1];if(r==="Ingredient Magnet S (Plus)")return[5,7,9,11,13,16,18][e-1];if(r==="Charge Energy S"||r==="Charge Energy S (Moonlight)")return[12,16,21,27,34,43][e-1];if(r==="Charge Strength S")return[400,569,785,1083,1496,2066,3002][e-1];if(r==="Charge Strength S (Stockpile)")return[644.3,915.95,1263.97,1745.19,2408.59,3327.75,4834.38][e-1];if(r==="Charge Strength S (Random)")return[500,711.5,981.5,1354,1870,2582.5,3752.5][e-1];if(r==="Charge Strength M")return[880,1251,1726,2383,3290,4546,6409][e-1];if(r==="Charge Strength M (Bad Dreams)")return[2640,3753,5178,7149,9870,13638,17304][e-1];if(r==="Cooking Power-Up S")return[7,10,12,17,22,27,31][e-1];if(r==="Cooking Power-Up S (Minus)")return[5,7,9,12,16,20,24][e-1];if(r==="Energizing Cheer S")return[12,15,20,25,33,44][e-1];if(r==="Energy for Everyone S")return[5,7,9,11,15,18][e-1];if(r==="Energy for Everyone S (Lunar Blessing)")return[3,4,5,7,9,11][e-1];if(r==="Extra Helpful S")return[6,7,8,9,10,11,12][e-1];if(r==="Helper Boost")switch(t){case 1:return[2,3,3,4,4,5][e-1];case 2:return[2,3,3,4,5,6][e-1];case 3:return[3,4,5,6,7,8][e-1];case 4:return[4,5,6,7,8,9][e-1];case 5:return[6,7,8,9,10,11][e-1];default:throw new Error(`invalid species count: ${t}`)}return r==="Dream Shard Magnet S"?[240,340,480,670,920,1260,1800,2500][e-1]:r==="Dream Shard Magnet S (Random)"?[300,425,600,837.5,1150,1575,2250,2875][e-1]:r==="Tasty Chance S"?[4,5,6,7,8,10][e-1]:r==="Berry Burst (Disguise)"?[8,10,15,17,19,21][e-1]:r==="Berry Burst"?[11,14,21,24,27,30][e-1]:r==="Ingredient Draw S"||r==="Ingredient Draw S (Super Luck)"||r==="Ingredient Draw S (Hyper Cutter)"?[5,6,8,11,13,16,18][e-1]:[0,0,0,0,0,0,0][e-1]}function O(r,e,t){if(e!==Math.floor(e))throw new Error(`invalid skill level: ${e}`);if(e<0||e>L(r))throw new Error(`invalid main skill: ${r}, ${e}`);if(r.startsWith("Berry Burst"))return[1,2,2,3,4,5][e-1];if(r==="Ingredient Magnet S (Plus)"){if(t==="coffee")return[6,7,8,9,10,11,12][e-1];if(t==="milk")return[6,7,9,10,12,13,14][e-1];throw new Error(`invalid ingredient: ${t}`)}if(r==="Cooking Power-Up S (Minus)")return[8,10,13,17,23,30,35][e-1];if(r==="Ingredient Draw S (Super Luck)")return[500,720,1030,1440,2e3,2800,4e3][e-1];throw new Error(`This skill doesn’t have a sub-value: ${r}`)}function Me(r,e){switch(r){case 1:switch(e){case 1:return{myBerryCount:5,othersBerryCount:1};case 2:return{myBerryCount:7,othersBerryCount:1};case 3:return{myBerryCount:9,othersBerryCount:1};case 4:return{myBerryCount:12,othersBerryCount:1};case 5:return{myBerryCount:14,othersBerryCount:2}}break;case 2:switch(e){case 1:return{myBerryCount:9,othersBerryCount:1};case 2:return{myBerryCount:12,othersBerryCount:1};case 3:return{myBerryCount:15,othersBerryCount:1};case 4:return{myBerryCount:16,othersBerryCount:2};case 5:return{myBerryCount:19,othersBerryCount:3}}break;case 3:switch(e){case 1:return{myBerryCount:13,othersBerryCount:1};case 2:return{myBerryCount:17,othersBerryCount:1};case 3:return{myBerryCount:18,othersBerryCount:2};case 4:return{myBerryCount:20,othersBerryCount:3};case 5:return{myBerryCount:24,othersBerryCount:4}}break;case 4:switch(e){case 1:return{myBerryCount:17,othersBerryCount:1};case 2:return{myBerryCount:19,othersBerryCount:2};case 3:return{myBerryCount:25,othersBerryCount:2};case 4:return{myBerryCount:28,othersBerryCount:3};case 5:return{myBerryCount:29,othersBerryCount:5}}break;case 5:switch(e){case 1:return{myBerryCount:21,othersBerryCount:1};case 2:return{myBerryCount:24,othersBerryCount:2};case 3:return{myBerryCount:27,othersBerryCount:3};case 4:return{myBerryCount:28,othersBerryCount:5};case 5:return{myBerryCount:30,othersBerryCount:7}}break;case 6:switch(e){case 1:return{myBerryCount:25,othersBerryCount:1};case 2:return{myBerryCount:29,othersBerryCount:2};case 3:return{myBerryCount:30,othersBerryCount:4};case 4:return{myBerryCount:31,othersBerryCount:6};case 5:return{myBerryCount:32,othersBerryCount:9}}break}throw new Error(`Lunar Blessing doesn’t have a sub-value: ${r}, ${e}`)}function _e(r,e){switch(r){case"Charge Strength S (Random)":switch(e){case 1:return[200,800];case 2:return[285,1138];case 3:return[393,1570];case 4:return[542,2166];case 5:return[748,2992];case 6:return[1033,4132];case 7:return[1501,6004]}break;case"Charge Strength S (Stockpile)":switch(e){case 1:return[600,12120];case 2:return[853,17231];case 3:return[1177,23776];case 4:return[1625,32827];case 5:return[2243,45309];case 6:return[3099,62600];case 7:return[4502,90940]}break;case"Dream Shard Magnet S (Random)":switch(e){case 1:return[120,480];case 2:return[170,680];case 3:return[240,960];case 4:return[335,1340];case 5:return[460,1840];case 6:return[630,2520];case 7:return[900,3600];case 8:return[1150,4600]}break}return[0,0]}function Ge(r,e,t,i){let n=r.skill;return t&&r.id===ee&&i!==void 0&&(n=i.nature.isAmped?"Ingredient Magnet S (Plus)":"Cooking Power-Up S (Minus)"),!!(n.startsWith(e)||n==="Cooking Power-Up S (Minus)"&&e==="Energizing Cheer S"||n==="Energy for Everyone S (Lunar Blessing)"&&e==="Berry Burst")}const he=-2,ge=-1,te=0,Ae=["berry","ing","skill"],Fe=.1,xe=1,Pe=2.4,ye=1,fe=.5,Te=1.25,Re=.15,Le={1:0,10:18,20:35,30:61,40:96,50:142,55:171,60:203,65:234};class He{iv;param;isWhistle;constructor(e,t,i){if(this.param=t,this.isWhistle=!1,t.period===te&&(this.isWhistle=!0,this.param={...t,period:3,isEnergyAlwaysFull:!0,isGoodCampTicketSet:!1,tapFrequency:"always",tapFrequencyAsleep:"always"}),this.iv=this.changePokemonIv(e,i),N.find(o=>o.name===e.pokemonName)===void 0)throw new Error(`Unknown name: ${e.pokemonName}`)}get pokemonIv(){return this.iv}get parameter(){return this.param}changePokemonIv(e,t){const i=this.param;if(i.level!==0&&(e=e.changeLevel(i.level)),!i.evolved)return e;const n=e.decendants;if(n.length===0)return e;let o=n.find(s=>s.id===e.pokemon.id);return o!==void 0||(o=n.find(s=>s.id===t),o===void 0&&(o=n[0]),o.id!==e.pokemon.id&&(e=e.clone(o.name))),e}calculate(){const e=this.param,t=new q(this.iv),i=t.level,n=Math.ceil(e.period/24),o=this.bonusEffects,s=new Ce(this.iv).calculate(e,o,this.isWhistle),u=e.period<0?-e.period:e.tapFrequency==="none"?0:(s.helpCount.awake+s.helpCount.asleepNotFull)*n,l=e.period<0?0:e.tapFrequency==="none"?(s.helpCount.awake+s.helpCount.asleepNotFull+s.helpCount.asleepFull)*n:s.helpCount.asleepFull*n,c=((e.recipeBonus===0?1:(1+e.recipeBonus/100)*(1+Le[e.recipeLevel]/100))*.8+.2)*(1+e.fieldBonus/100)*o.dish,p=t.ingredientRatio,f=u*p,a=1+(i>=30&&t.ingredient2.count>0?1:0)+(i>=60&&t.ingredient3.count>0?1:0),v=e.period!==te?o.ingredient:0,S={...t.ingredient1,strength:0,helpCount:t.ingredient1.count+v};S.count=f*(1/a)*S.helpCount,S.strength=A[S.name]*S.count*c;const d={...t.ingredient2,strength:0,helpCount:t.ingredient2.count+v};d.count=i<30||d.count===0?0:f*(1/a)*d.helpCount,d.strength=A[d.name]*d.count*c;let m;m={...t.ingredient3,strength:0,helpCount:t.ingredient3.count+v},m.count=i<60||m.count===0?0:f*(1/a)*m.helpCount,m.strength=A[m.name]*m.count*c;const F=S.strength+d.strength+m.strength,b={},B=[];b[S.name]={...S},B.push(S.name),d.count>0&&(d.name in b||(b[d.name]={name:d.name,count:0,helpCount:0,strength:0},B.push(d.name)),b[d.name].count+=d.count,b[d.name].helpCount+=d.helpCount,b[d.name].strength+=d.strength),m!==void 0&&m.count>0&&(m.name in b||(b[m.name]={name:m.name,count:0,helpCount:0,strength:0},B.push(m.name)),b[m.name].count+=m.count,b[m.name].helpCount+=m.helpCount,b[m.name].strength+=m.strength);const E=B.map(R=>b[R]),H=this.iv.pokemon.frequency>0?1-p:0,z=u+l-f,$=t.berryCount,_=t.berryCount+o.berry,G=t.berryStrength,x=Math.ceil(G*(1+e.fieldBonus/100)),P=Math.ceil(x*this.berryStrengthBonus),T=P*_*(u*(1-p))+ +P*$*l,g=s.skillRatio;let y=0,I=0,D=0,U=0,K=0,j=0,ie=0;if(e.period>0&&!this.isWhistle&&e.tapFrequency!=="none"){if(e.tapFrequencyAsleep==="always")y=(s.helpCount.awake+s.helpCount.asleepNotFull)*g*n;else{const R=s.helpCount.awake*g,X=s.skillProbabilityAfterWakeup.once+s.skillProbabilityAfterWakeup.twice*2;y=(R+X)*n}({skillValue:I,skillStrength:D,skillValuePerTrigger:U,skillValue2:K,skillStrength2:j,skillValuePerTrigger2:ie}=this.getSkillValueAndStrength(y,e,o))}let J=(e.totalFlags[1]?F:0)+(e.totalFlags[0]?T:0)+(e.totalFlags[2]?D+j:0),Q=0;if(e.addHelpingBonusEffect&&this.pokemonIv.hasHelpingBonusInActiveSubSkills){const R=1-.05*e.helpBonusCount,X=1-.05*(e.helpBonusCount+1),de=R/X-1;Q=J*de*4,J+=Q}return{bonus:o,energy:s,totalStrength:J,helpingBonusStrength:Q,notFullHelpCount:u,fullHelpCount:l,ingRatio:p,ingHelpCount:f,ingStrength:F,ing1:S,ing2:d,ing3:m,ingredients:E,berryRatio:H,berryHelpCount:z,berryCount:$,berryStrength:x,berryRawStrength:G,berryTotalStrength:T,skillRatio:g,skillCount:y,skillValue:I,skillStrength:D,skillValuePerTrigger:U,skillValue2:K,skillStrength2:j,skillValuePerTrigger2:ie}}getSkillValueAndStrength(e,t,i){const n=this.iv.pokemon.skill,o=this.getSkillLevel(),s=Math.ceil(t.period/24);let u=ne(n,o);n.startsWith("Ingredient Magnet S")&&(u=Math.floor(u*i.ingredientMagnet)),n.startsWith("Ingredient Draw S")&&(u=Math.floor(u*i.ingredientDraw)),n.startsWith("Dream Shard Magnet S")&&(u*=i.dreamShard);let l=1;n==="Charge Energy S"&&(l=this.iv.nature.energyRecoveryFactor);const h=u*l,c=h*e,p=300*(1+t.fieldBonus/100),f=(1+t.fieldBonus/100)*i.dish;switch(n){case"Charge Energy S":case"Charge Energy S (Moonlight)":case"Energizing Cheer S":case"Energy for Everyone S":return{skillValue:c,skillStrength:0,skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};case"Energy for Everyone S (Lunar Blessing)":{const a=Y(this.iv,t,i.berryBurst,o);return{skillValue:c,skillStrength:0,skillValuePerTrigger:h,skillValue2:a.total*e,skillStrength2:a.total*e,skillValuePerTrigger2:a.total}}case"Dream Shard Magnet S":case"Dream Shard Magnet S (Random)":return{skillValue:c,skillStrength:0,skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};case"Charge Strength M":case"Charge Strength M (Bad Dreams)":case"Charge Strength S":case"Charge Strength S (Random)":case"Charge Strength S (Stockpile)":{const a=c*(1+t.fieldBonus/100);return{skillValue:a,skillStrength:a,skillValuePerTrigger:u*(1+t.fieldBonus/100),skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0}}case"Extra Helpful S":return{skillValue:c,skillStrength:c*p,skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};case"Helper Boost":return{skillValue:c,skillStrength:c*p*5,skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};case"Berry Burst (Disguise)":{const a=Y(this.iv,t,i.berryBurst,o),v=1-Math.pow(1-.18,e/s),S=a.total*e+a.total*v*2;return{skillValue:S,skillStrength:S,skillValuePerTrigger:a.total,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0}}case"Berry Burst":{const a=Y(this.iv,t,i.berryBurst,o);return{skillValue:a.total*e,skillStrength:a.total*e,skillValuePerTrigger:a.total,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0}}case"Ingredient Magnet S (Plus)":{let a=O(n,o,this.pokemonIv.pokemon.ing1.name);return a=Math.floor(a*i.ingredientMagnet),{skillValue:c,skillStrength:c*W*f,skillValuePerTrigger:h,skillValue2:a*e,skillStrength2:a*A[this.iv.pokemon.ing1.name]*f*e,skillValuePerTrigger2:a}}case"Cooking Power-Up S (Minus)":{const a=O(n,o);return{skillValue:c,skillStrength:c*W*f,skillValuePerTrigger:h,skillValue2:a*e,skillStrength2:0,skillValuePerTrigger2:a}}case"Ingredient Magnet S":return{skillValue:c,skillStrength:c*W*f,skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};case"Ingredient Draw S":return{skillValue:c,skillStrength:c*135.66666666666666*f,skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};case"Ingredient Draw S (Super Luck)":{const v=O(n,o),S=v*Ee+v*5*Ie;return{skillValue:c*oe,skillStrength:c*oe*123.75*f,skillValuePerTrigger:h,skillValue2:S*e,skillStrength2:0,skillValuePerTrigger2:S}}case"Ingredient Draw S (Hyper Cutter)":return{skillValue:c*(1+le),skillStrength:c*130.75*f*(1+le),skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};case"Cooking Power-Up S":return{skillValue:c,skillStrength:c*W*f,skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};case"Tasty Chance S":return{skillValue:c,skillStrength:0,skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};case"Metronome":case"Skill Copy":case"Skill Copy (Transform)":case"Skill Copy (Mimic)":return{skillValue:e,skillStrength:0,skillValuePerTrigger:1,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0};default:return{skillValue:c,skillStrength:0,skillValuePerTrigger:h,skillValue2:0,skillStrength2:0,skillValuePerTrigger2:0}}}getSkillLevel(){const e=this.param,t=L(this.iv.pokemon.skill),i=this.bonusEffects;let n=Math.min(t,this.iv.skillLevel+i.skillLevel);return e.maxSkillLevel&&(n=t),n}get bonusEffects(){const e=this.param;if(this.isWhistle)return{...ue,skillTriggerReason:"none",skillLevelReason:"none",ingredientReason:"none"};const t=ce(e.event,e.customEventBonus),i=Se(e.event,e.customEventBonus,this.iv.pokemon),n=Z(e.fieldIndex),o=n&&e.favoriteType[0]===this.iv.pokemon.type,s=n&&e.favoriteType.includes(this.iv.pokemon.type),u=n&&o?xe:0,l=n&&s&&this.param.expertEffect==="ing"&&(this.iv.pokemon.specialty==="Ingredients"||this.iv.pokemon.specialty==="All")?fe:0,h=n&&s&&this.param.expertEffect==="ing"?ye+l:0,c=n&&s&&this.param.expertEffect==="skill"?Te:1,p=i?.skillTrigger??1,f=i?.skillLevel??0,a=i?.ingredient??0;return{skillTrigger:Math.max(c,p),skillTriggerReason:c>p?"ex":"event",skillLevel:u+f,skillLevelReason:u*f!==0?"event+ex":u>0?"ex":"event",berry:i?.berry??0,ingredient:Math.max(h,a),ingredientReason:h>a?"ex":"event",dreamShard:t?.dreamShard??1,ingredientMagnet:t?.ingredientMagnet??1,ingredientDraw:t?.ingredientDraw??1,berryBurst:t?.berryBurst??1,dish:t?.dish??1,energyFromDish:t?.energyFromDish??0}}get berryStrengthBonus(){return Z(this.param.fieldIndex)&&this.param.expertEffect==="berry"&&this.param.favoriteType.includes(this.iv.pokemon.type)?Pe:this.isFavoriteBerry?2:1}get isFavoriteBerry(){if(this.param.fieldIndex===ge)return!1;if(this.param.fieldIndex===he)return!0;const{types:e}=pe(this.param);return e.includes(this.iv.pokemon.type)}}function We(r){return r==="Charge Energy S"||r==="Charge Energy S (Moonlight)"||r==="Energizing Cheer S"||r==="Energy for Everyone S"||r==="Dream Shard Magnet S"||r==="Dream Shard Magnet S (Random)"||r==="Tasty Chance S"||r==="Metronome"||r==="Skill Copy"||r==="Skill Copy (Transform)"||r==="Skill Copy (Mimic)"}function pe(r){const e=ce(r.event,r.customEventBonus),t=e?.fixedBerries??[],i=e?.fixedAreas??[],n=me(r.fieldIndex);let o=[],s=["random","random","random"];if(i.includes(r.fieldIndex)&&t.length===3){for(let u=0;u<3;u++)t[u]===null?s[u]="random":s[u]="set for event";o=[...r.favoriteType]}else n.length===3?(s=["set for field","set for field","set for field"],o=n):o=r.favoriteType;return{types:o,reasons:s}}function De(r){return{...{period:24,fieldBonus:0,fieldIndex:ge,favoriteType:["normal","fire","water"],helpBonusCount:0,e4eEnergy:18,e4eCount:3,recoveryBonusCount:0,isEnergyAlwaysFull:!1,sleepScore:100,isGoodCampTicketSet:!1,expertEffect:"berry",event:"none",level:0,evolved:!1,maxSkillLevel:!1,totalFlags:[!0,!0,!0],addHelpingBonusEffect:!0,tapFrequency:"always",tapFrequencyAsleep:"none",recipeBonus:25,recipeLevel:30,helperBoostLevel:6,helperBoostSpecies:4,berryBurstTeam:{auto:!0,species:3,members:[{type:"electric",level:50},{type:"water",level:50},{type:"bug",level:50},{type:"psychic",level:50}]},customEventBonus:{target:{},effects:{berry:0,skillTrigger:1,skillLevel:0,ingredient:0,dreamShard:1,ingredientMagnet:1,ingredientDraw:1,berryBurst:1,dish:1,energyFromDish:0,fixedAreas:[],fixedBerries:[]}}},...r}}function Ue(r,e){if(!e.berryBurstTeam.auto)return e.berryBurstTeam.members;const t=r.level,i=pe(e).types,n=i.filter(s=>s!==r.pokemon.type),o=i.find(s=>s==="psychic"||s==="electric"||s==="fairy")??"psychic";return[{type:r.pokemon.type,level:t},{type:n.length>0?n[0]:i[0],level:t},{type:"steel",level:t},{type:o,level:t}]}function Y(r,e,t,i){const n=i??r.skillLevel,o=Ue(r,e);let s,u;switch(r.pokemon.skill){case"Berry Burst":case"Berry Burst (Disguise)":s=Math.ceil(t*ne(r.pokemon.skill,n)),u=Math.ceil(t*O(r.pokemon.skill,n));break;case"Energy for Everyone S (Lunar Blessing)":{const p=Me(n,e.berryBurstTeam.auto?o.filter(f=>f.type===r.pokemon.type).length:e.berryBurstTeam.species);s=Math.floor(p.myBerryCount),u=Math.floor(p.othersBerryCount);break}default:throw new Error(`Invalid skill: ${r.pokemon.skill}`)}const l=[r.level,o[0].level,o[1].level,o[2].level,o[3].level],h=[r.pokemon.type,o[0].type,o[1].type,o[2].type,o[3].type],c={total:0,members:[]};for(let p=0;p<5;p++){const f=new V(N.find(m=>m.type===h[p])?.name??"Bulbasaur");f.level=l[p];const a=new q(f).berryStrength,v=Math.ceil(Math.ceil(a*(1+e.fieldBonus/100))*new He(f,e).berryStrengthBonus),S=p===0?s:u,d=v*S;c.total+=d,c.members.push({total:d,perBerry:v,count:S})}return c}function Oe(r,e,t){return new q(e.pokemonIv).getBagUsagePerHelp(t.bonus.berry,t.bonus.ingredient,!1)*Math.abs(r.period)}function Ne(r,e){const t=new q(r.pokemonIv).getBagUsagePerHelp(e.bonus.berry,e.bonus.ingredient,!1);return(999-e.energy.carryLimit)/t}function ze(r,e,t){const i=Ne(e,t),n=ne("Helper Boost",r.helperBoostLevel,r.helperBoostSpecies);return i/n}function Ke(){const r=De({}),e=localStorage.getItem("PstStrenghParam");if(e===null)return r;const t=JSON.parse(e);if(typeof t!="object"||t===null)return r;if(typeof t.period=="number"&&[1,3,8,16,24,168,te,-10,-30,-100].includes(t.period)&&(r.period=t.period),typeof t.fieldBonus=="number"&&Math.floor(t.fieldBonus)===t.fieldBonus&&t.fieldBonus>=0&&t.fieldBonus<=100&&(r.fieldBonus=Math.floor(t.fieldBonus)),typeof t.fieldIndex=="number"&&Math.floor(t.fieldIndex)===t.fieldIndex&&t.fieldIndex>=he&&t.fieldIndex<ke.length&&(r.fieldIndex=t.fieldIndex),Array.isArray(t.favoriteType)&&t.favoriteType.length===3&&t.favoriteType.every(n=>se.includes(n))&&(r.favoriteType=t.favoriteType),typeof t.helpBonusCount=="number"&&Math.floor(t.helpBonusCount)===t.helpBonusCount&&t.helpBonusCount>=0&&t.helpBonusCount<=4&&(r.helpBonusCount=t.helpBonusCount),typeof t.isGoodCampTicketSet=="boolean"&&(r.isGoodCampTicketSet=t.isGoodCampTicketSet),typeof t.expertEffect=="string"&&Ae.includes(t.expertEffect)&&(r.expertEffect=t.expertEffect),typeof t.level=="number"&&[0,10,25,30,50,55,60,75,100].includes(t.level)&&(r.level=t.level),typeof t.evolved=="boolean"&&(r.evolved=t.evolved),typeof t.maxSkillLevel=="boolean"&&(r.maxSkillLevel=t.maxSkillLevel),Array.isArray(t.totalFlags)&&t.totalFlags.length===3&&t.totalFlags.every(n=>typeof n=="boolean")&&(r.totalFlags=t.totalFlags),typeof t.addHelpingBonusEffect=="boolean"?r.addHelpingBonusEffect=t.addHelpingBonusEffect:r.addHelpingBonusEffect=!0,typeof t.e4eEnergy=="number"&&[5,7,9,11,15,18].includes(t.e4eEnergy)&&(r.e4eEnergy=t.e4eEnergy),typeof t.e4eCount=="number"&&t.e4eCount>=0&&t.e4eCount<=10&&(r.e4eCount=t.e4eCount),typeof t.recoveryBonusCount=="number"&&t.recoveryBonusCount>=0&&t.recoveryBonusCount<=5&&(r.recoveryBonusCount=Math.min(t.recoveryBonusCount,4)),typeof t.isEnergyAlwaysFull=="boolean"&&(r.isEnergyAlwaysFull=t.isEnergyAlwaysFull),typeof t.sleepScore=="number"&&0<=t.sleepScore&&t.sleepScore<=100&&(r.sleepScore=t.sleepScore),typeof t.tapFrequency=="string"&&["always","none"].includes(t.tapFrequency)&&(r.tapFrequency=t.tapFrequency),typeof t.tapFrequencyAsleep=="string"&&["always","none"].includes(t.tapFrequencyAsleep)&&(r.tapFrequencyAsleep=t.tapFrequencyAsleep),typeof t.recipeBonus=="number"&&[0,6,11,17,19,20,25,35,48,61,78].includes(t.recipeBonus)&&((t.recipeBonus===6||t.recipeBonus===11)&&(t.recipeBonus=19),t.recipeBonus===17&&(t.recipeBonus=21),r.recipeBonus=t.recipeBonus),typeof t.recipeLevel=="number"&&[1,10,20,30,40,50,55,60,65].includes(t.recipeLevel)&&(r.recipeLevel=t.recipeLevel),typeof t.helperBoostLevel=="number"&&t.helperBoostLevel>0&&t.helperBoostLevel<=L("Helper Boost")&&(r.helperBoostLevel=t.helperBoostLevel),typeof t.helperBoostSpecies=="number"&&t.helperBoostSpecies>0&&t.helperBoostSpecies<=6&&(r.helperBoostSpecies=t.helperBoostSpecies),typeof t.recipeLevel=="number"&&[1,10,20,30,40,50,55,60,65].includes(t.recipeLevel)&&(r.recipeLevel=t.recipeLevel),typeof t.berryBurstTeam=="object"&&(typeof t.berryBurstTeam.auto=="boolean"&&(r.berryBurstTeam.auto=t.berryBurstTeam.auto),Array.isArray(t.berryBurstTeam.members)))for(let n=0;n<4;n++)typeof t.berryBurstTeam.members[n]=="object"&&(se.includes(t.berryBurstTeam.members[n].type)&&(r.berryBurstTeam.members[n].type=t.berryBurstTeam.members[n].type),t.berryBurstTeam.members[n].level>0&&t.berryBurstTeam.members[n].level<=100&&(r.berryBurstTeam.members[n].level=t.berryBurstTeam.members[n].level));const i=ve.bonus.map(n=>n.name);return typeof t.event=="string"&&["none","custom",...i].includes(t.event)&&(r.event=t.event),typeof t.customEventBonus=="object"&&(r.customEventBonus=Be(t.customEventBonus)),r}const je=65,A={leek:185,mushroom:167,egg:115,potato:124,apple:90,herb:130,sausage:103,milk:98,honey:101,oil:121,ginger:109,tomato:110,cacao:151,tail:342,soy:100,corn:140,coffee:153,pumpkin:250,avocado:162,unknown:0,unknown1:0,unknown2:0,unknown3:0},W=(()=>{const r=Object.entries(A).filter(([t])=>!t.startsWith("unknown"));return r.reduce((t,[,i])=>t+i,0)/r.length})(),Ve={normal:28,fire:27,water:31,electric:25,grass:30,ice:32,fighting:27,poison:32,ground:29,flying:24,psychic:26,bug:24,rock:30,ghost:26,dragon:35,dark:31,steel:33,fairy:26},ae=["AAA","AAB","AAC","ABA","ABB","ABC"];class q{_pokemonName;_pokemon;level;skillLevel;ingredient;subSkills;nature;ribbon;mythIng1;mythIng2;mythIng3;get pokemonName(){return this._pokemonName}get pokemon(){return this._pokemon}get isMythical(){return this._pokemon.mythIng!==void 0}constructor(e){this._pokemonName=e.pokemonName,this._pokemon=e.pokemon,this.level=e.level,this.skillLevel=e.skillLevel,this.ingredient=e.ingredient,this.subSkills=e.subSkills,this.nature=e.nature,this.ribbon=e.ribbon,this.mythIng1=e.mythIng1,this.mythIng2=e.mythIng2,this.mythIng3=e.mythIng3}calculate(){const e=this.frequency,t=this.bonus,i=this.ingredientRp,n=this.berryRp,o=this.skillRp;return{rp:Math.round((M(i)+M(n)+M(o))*M(t)/1e4),frequency:e,ingredientRp:w(i*t,1),berryRp:w(n*t,1),skillRp:w(o*t,1)}}get Rp(){return Math.round((M(this.ingredientRp)+M(this.berryRp)+M(this.skillRp))*M(this.bonus)/1e4)}get activeSubSkills(){return this.subSkills.getActiveSubSkills(this.level)}get helpCountPer5Hour(){const e=this.frequency;return e===0?0:5*w(3600/e,2)}get frequency(){const e=this.level===10&&this._pokemon.frequency===2600?.1:0;return this._pokemon.frequency*w((501-this.level)/500*(this.nature?.speedOfHelpFactor??1)*this.speedOfRibbonFactor*(1-this.activeSubSkills.reduce((t,i)=>t+i.helpingSpeed,0)*.07),4)-e}get speedOfRibbonFactor(){if(this.pokemon.evolutionLeft===0)return 1;if(this.ribbon>=4)switch(this.pokemon.evolutionLeft){case 2:return .75;case 1:return .88}if(this.ribbon>=2)switch(this.pokemon.evolutionLeft){case 2:return .89;case 1:return .95}return 1}frequencyWithHelpingBonus(e){const t=this.activeSubSkills.reduce((n,o)=>n+o.helpingSpeed,0)*.07,i=Math.min(t+.05*e,.35);return this._pokemon.frequency*w((501-this.level)/500*(this.nature?.speedOfHelpFactor??1)*this.speedOfRibbonFactor*(1-i),4)}getBaseFrequency(e,t,i,n){return this.frequencyWithHelpingBonus(e)/(t?1.2:1)*(i?1-Fe:1)*(n?1+Re:1)}get hasHelpingBonusInActiveSubSkills(){return this.activeSubSkills.some(e=>e.name==="Helping Bonus")}get bonus(){return w(this.energyBonus*this.subSkillBonus,2)}get energyBonus(){return this.nature?.isEnergyRecoveryUp?1.08:this.nature?.isEnergyRecoveryDown?.92:1}get subSkillBonus(){let e=0;for(const t of this.activeSubSkills){switch(t.inventory){case 3:e+=.181;break;case 2:e+=.139;break;case 1:e+=.071;break}t.isBonus&&(e+=.221)}return 1+e}get ingredientRp(){return w(this.helpCountPer5Hour*this.ingredientRatio*this.ingredientEnergy*this.ingredientG,2)}get ingredientRatio(){return w(this._pokemon.ingRatio/100*(this.nature?.ingredientFindingFactor??1)*(1+this.activeSubSkills.reduce((e,t)=>e+t.ingredientFinder,0)*.18),4)}get ingredientEnergy(){const e=this.ingredient1,t=A[e.name]*e.count;let i=1;if(this.level<30)return t;const n=this.ingredient2,o=A[n.name]*n.count;if(o>0&&i++,this.level<60)return Math.floor((t+o)/i);const s=this.ingredient3,u=A[s.name]*s.count;return u>0&&i++,Math.floor((t+o+u)/i)}get ingredient1(){return this._pokemon.mythIng!==void 0?{name:this.mythIng1??"unknown",count:this._pokemon.mythIng.find(e=>e.name===this.mythIng1)?.c1??0}:{name:this._pokemon.ing1.name??"unknown",count:this._pokemon.ing1.c1}}get ingredient2(){if(this._pokemon.mythIng!==void 0)return{name:this.mythIng2??"unknown",count:this._pokemon.mythIng.find(t=>t.name===this.mythIng2)?.c2??0};const e=this.ingredient.charAt(1)==="A"?this._pokemon.ing1:this._pokemon.ing2;return{name:e.name,count:e.c2}}get ingredient3(){if(this._pokemon.mythIng!==void 0)return{name:this.mythIng3??"unknown",count:this._pokemon.mythIng.find(t=>t.name===this.mythIng3)?.c3??0};const e=this.ingredient.charAt(2)==="A"?this._pokemon.ing1:this.ingredient.charAt(2)==="B"?this._pokemon.ing2:this._pokemon.ing3;if(e===void 0)throw new Error("this pokemon doesn't have 3rd ing");return{name:e.name,count:e.c3}}get ingredientG(){const e=[1,1.003,1.007,1.011,1.016,1.021,1.027,1.033,1.039,1.046,1.053,1.061,1.069,1.077,1.085,1.094,1.104,1.114,1.124,1.134,1.145,1.156,1.168,1.18,1.192,1.205,1.218,1.231,1.245,1.259,1.274,1.288,1.303,1.319,1.335,1.351,1.368,1.385,1.402,1.42,1.439,1.457,1.477,1.496,1.517,1.537,1.558,1.58,1.602,1.625,1.648,1.671,1.696,1.72,1.745,1.771,1.798,1.824,1.852,1.88,1.927,1.975,2.024,2.075,2.127,2.18,2.234,2.289,2.345,2.402,2.46,2.519,2.579,2.64,2.702,2.765,2.829,2.894,2.96,3.027,3.095,3.164,3.234,3.305,3.377,3.45,3.524,3.599,3.675,3.752,3.83,3.909,3.989,4.07,4.152,4.235,4.319,4.404,4.49,4.577];return this.level-1<e.length?e[this.level-1]:398e-9*Math.pow(this.level,3)+159e-6*Math.pow(this.level,2)+.00367*this.level-.00609+1}getBagUsagePerHelp(e,t,i){const n=this.berryCount+e,o=this.ingredientRatio;let s=t;i&&(s+=ye,this.pokemon.specialty==="Ingredients"&&(s+=fe));const u=this.level<30?this.ingredient1.count+s:this.level<60?(this.ingredient1.count+this.ingredient2.count+s)/2:(this.ingredient1.count+this.ingredient2.count+this.ingredient3.count+s)/3;return(1-o)*n+o*u}get berryRp(){return w(this.helpCountPer5Hour*this.berryRatio*this.berryStrength*this.berryCount,2)}get berryRatio(){return this.ingredientRatio>0?1-this.ingredientRatio:0}get berryCount(){return(this._pokemon.specialty==="Berries"||this._pokemon.specialty==="All"?2:1)+(this.activeSubSkills.some(t=>t.isBFS)?1:0)}get berryStrength(){const e=Ve[this._pokemon.type];return Math.max(e+this.level-1,Math.round(Math.pow(1.025,this.level-1)*e))}get skillRp(){return w(this.helpCountPer5Hour*this.skillRatio*this.skillValue,2)}get skillRatio(){return w(this._pokemon.skillRatio/100*(this.nature?.mainSkillChanceFactor??1)*(1+this.activeSubSkills.reduce((e,t)=>e+t.skillTrigger,0)*.18),4)}get skillValue(){return this._pokemon.skill==="Charge Strength S"||this._pokemon.skill==="Charge Strength S (Random)"||this._pokemon.skill==="Charge Energy S"?[400,569,785,1083,1496,2066,2656][this.skillLevel-1]:this._pokemon.skill==="Charge Energy S (Moonlight)"?[560,797,1099,1516,2094,2892][this.skillLevel-1]:this._pokemon.skill==="Charge Strength S (Stockpile)"||this._pokemon.skill==="Skill Copy (Transform)"||this._pokemon.skill==="Skill Copy (Mimic)"?[600,853,1177,1625,2243,3099,3984][this.skillLevel-1]:this._pokemon.skill==="Energy for Everyone S"?[1120,1593,2197,3033,4187,5785][this.skillLevel-1]:this._pokemon.skill==="Helper Boost"?[2800,3902,5273,6975,9317,12438][this.skillLevel-1]:this._pokemon.skill==="Berry Burst (Disguise)"||this._pokemon.skill==="Berry Burst"||this._pokemon.skill==="Energy for Everyone S (Lunar Blessing)"?[1400,1991,2747,3791,5234,7232][this.skillLevel-1]:this._pokemon.skill==="Charge Strength M (Bad Dreams)"?[2400,3313,4643,6441,8864,11878,13140][this.skillLevel-1]:this._pokemon.skill==="Energizing Cheer S"?[766,1089,1502,2074,2863,3956][this.skillLevel-1]:[880,1251,1726,2383,3290,4546,5843,7303][this.skillLevel-1]}}function w(r,e){const t=Math.pow(10,e),i=parseFloat((r*t).toFixed(6));return Math.floor(i)/t}function M(r){return parseFloat((r*100).toFixed(6))}class C{value;static goldSubSkillNames=["Berry Finding S","Dream Shard Bonus","Energy Recovery Bonus","Helping Bonus","Research EXP Bonus","Skill Level Up M","Sleep EXP Bonus"];static blueSubSkillNames=["Helping Speed M","Ingredient Finder M","Inventory Up L","Inventory Up M","Skill Level Up S","Skill Trigger M"];static whiteSubSkillNames=["Helping Speed S","Ingredient Finder S","Inventory Up S","Skill Trigger S"];static subSkillNames=[...this.goldSubSkillNames,...this.blueSubSkillNames,...this.whiteSubSkillNames];static allSubSkillsCache=[];constructor(e){if(!C.subSkillNames.includes(e))throw new Error(`Invalid subskill specified: ${e}`);this.value=e}get name(){return this.value}get isGold(){return C.goldSubSkillNames.includes(this.value)}get isBlue(){return C.blueSubSkillNames.includes(this.value)}get isWhite(){return C.whiteSubSkillNames.includes(this.value)}get index(){return C.allSubSkills.findIndex(e=>e.name===this.name)}get skillLevelUp(){switch(this.value){case"Skill Level Up M":return 2;case"Skill Level Up S":return 1;default:return 0}}get skillTrigger(){switch(this.value){case"Skill Trigger M":return 2;case"Skill Trigger S":return 1;default:return 0}}get inventory(){switch(this.value){case"Inventory Up L":return 3;case"Inventory Up M":return 2;case"Inventory Up S":return 1;default:return 0}}get helpingSpeed(){switch(this.value){case"Helping Speed M":return 2;case"Helping Speed S":return 1;default:return 0}}get ingredientFinder(){switch(this.value){case"Ingredient Finder M":return 2;case"Ingredient Finder S":return 1;default:return 0}}get isBFS(){return this.value==="Berry Finding S"}get isBonus(){switch(this.value){case"Helping Bonus":return!0;case"Sleep EXP Bonus":return!0;case"Dream Shard Bonus":return!0;case"Research EXP Bonus":return!0;case"Energy Recovery Bonus":return!0;default:return!1}}static get allSubSkillNames(){return[...this.subSkillNames]}static get allSubSkills(){return C.allSubSkillsCache.length===0&&(C.allSubSkillsCache=C.subSkillNames.map(e=>new C(e))),[...C.allSubSkillsCache]}}class re{value;constructor(e){e===void 0?this.value=[null,null,null,null,null]:e instanceof Array?this.value=e:this.value=[...e.value]}set(e,t){const i=this.getIndex(e);if(t!==null){const n=this.getSubSkillIndex(t);n>=0&&(this.value[n]=this.value[i])}this.value[i]=t}clone(){const e=new re;return e.value=[...this.value],e}isEqual(e){return this.lv10?.name===e.lv10?.name&&this.lv25?.name===e.lv25?.name&&this.lv50?.name===e.lv50?.name&&this.lv75?.name===e.lv75?.name&&this.lv100?.name===e.lv100?.name}getActiveSubSkills(e){const t=[];return e<10||(this.value[0]!==null&&t.push(this.value[0]),e<25)||(this.value[1]!==null&&t.push(this.value[1]),e<50)||(this.value[2]!==null&&t.push(this.value[2]),e<75)||(this.value[3]!==null&&t.push(this.value[3]),e<100)||this.value[4]!==null&&t.push(this.value[4]),t}getSubSkillIndex(e){return e===null?-1:this.value[0]?.name===e.name?0:this.value[1]?.name===e.name?1:this.value[2]?.name===e.name?2:this.value[3]?.name===e.name?3:this.value[4]?.name===e.name?4:-1}getSubSkillLevel(e){switch(this.getSubSkillIndex(e)){case 0:return 10;case 1:return 25;case 2:return 50;case 3:return 75;case 4:return 100;default:return-1}}getIndex(e){switch(e){case 10:return 0;case 25:return 1;case 50:return 2;case 75:return 3;case 100:return 4;default:return-1}}get lv10(){return this.value[0]}set lv10(e){this.set(10,e)}get lv25(){return this.value[1]}set lv25(e){this.set(25,e)}get lv50(){return this.value[2]}set lv50(e){this.set(50,e)}get lv75(){return this.value[3]}set lv75(e){this.set(75,e)}get lv100(){return this.value[4]}set lv100(e){this.set(100,e)}}class V{pokemonName;pokemon;level;skillLevel;ingredient;subSkills;nature;ribbon;mythIng1;mythIng2;mythIng3;constructor(e){this.pokemonName=e;const t=N.find(i=>i.name===e);if(t===void 0)throw new Error(`Unknown name: ${e}`);this.pokemon=t,this.level=30,this.skillLevel=Math.max(t.evolutionCount+1,1),this.ingredient=t.ing3!==void 0?"ABC":"ABB",this.subSkills=new re,this.nature=new k(e==="Toxtricity (Amped)"?"Hardy":"Serious"),this.ribbon=0,this.mythIng1=this.mythIng2=this.mythIng3="unknown",this.isMythical&&(this.mythIng1="sausage")}get isMythical(){return this.pokemon.mythIng!==void 0}get activeSubSkills(){return this.subSkills.getActiveSubSkills(this.level)}clone(e){const t=new V(e??this.pokemonName);if(t.level=this.level,t.skillLevel=this.skillLevel,this.pokemon.id!==t.pokemon.id){const i=Math.max(0,t.pokemon.evolutionCount)-Math.max(0,this.pokemon.evolutionCount);t.skillLevel+=i}return t.ingredient=this.ingredient,t.subSkills=this.subSkills.clone(),t.nature=this.nature,t.ribbon=this.ribbon,t.mythIng1=this.mythIng1,t.mythIng2=this.mythIng2,t.mythIng3=this.mythIng3,t.normalize(),t}changeLevel(e){const t=this.clone();t.level=e;const i=this.activeSubSkills.reduce((o,s)=>o+s.skillLevelUp,0),n=t.activeSubSkills.reduce((o,s)=>o+s.skillLevelUp,0);return t.skillLevel+=n-i,t.normalize(),t}changeSubSkills(e){const t=this.clone();t.subSkills=e;const i=this.activeSubSkills.reduce((o,s)=>o+s.skillLevelUp,0),n=t.activeSubSkills.reduce((o,s)=>o+s.skillLevelUp,0);return t.skillLevel+=n-i,t.normalize(),t}getIngredients(e){if(this.isMythical){const i=[this.mythIng1];return(!e||this.level>=30)&&this.mythIng2!=="unknown"&&i[0]!==this.mythIng2&&i.push(this.mythIng2),(!e||this.level>=60)&&this.mythIng3!=="unknown"&&i.includes(this.mythIng3)&&i.push(this.mythIng3),i}const t=[this.pokemon.ing1.name];if((!e||this.level>=30)&&this.ingredient.charAt(1)==="B"&&t.push(this.pokemon.ing2.name),!e||this.level>=60){const i=this.ingredient.charAt(2)==="A"?this.pokemon.ing1:this.ingredient.charAt(2)==="B"?this.pokemon.ing2:this.pokemon.ing3;i!==void 0&&!t.includes(i.name)&&t.push(i.name)}return t}normalize(){const e=L(this.pokemon.skill);this.skillLevel=Math.min(e,Math.max(this.skillLevel,1)),this.ingredient.endsWith("C")&&this.pokemon.ing3===void 0&&(this.ingredient=this.ingredient.replace("C","A")),this.isMythical&&this.mythIng1==="unknown"&&(this.mythIng1="sausage"),this.pokemon.id===be&&(this.pokemon.form==="Amped"&&this.nature.isLowKey?this.nature=k.allNatures.filter(t=>t.isAmped).filter(t=>t.upEffect===this.nature.upEffect)[0]??new k("Hardy"):this.pokemon.form==="Low Key"&&this.nature.isAmped&&(this.nature=k.allNatures.filter(t=>t.isLowKey).filter(t=>t.upEffect===this.nature.upEffect)[0]??new k("Serious")))}isEqual(e){const t=this.pokemonName===e.pokemonName&&this.level===e.level&&this.skillLevel===e.skillLevel&&this.subSkills.isEqual(e.subSkills)&&this.nature.name===e.nature.name&&this.ribbon===e.ribbon;return this.isMythical?t&&this.mythIng1===e.mythIng1&&this.mythIng2===e.mythIng2&&this.mythIng3===e.mythIng3:t&&this.ingredient===e.ingredient}get decendants(){return this.getDecendants(!1)}get allDecendants(){return this.getDecendants(!0)}getDecendants(e){const t=we(this.pokemon,e);return this.pokemon.ancestor===ee?t.filter(i=>i.id===ee||i.form==="Amped"&&this.nature.isAmped||i.form==="Low Key"&&this.nature.isLowKey):t}get hasHelpingBonusInActiveSubSkills(){return this.subSkills.getActiveSubSkills(this.level).some(e=>e.name==="Helping Bonus")}get hasEnergyRecoveryBonusInActiveSubSkills(){return this.subSkills.getActiveSubSkills(this.level).some(e=>e.name==="Energy Recovery Bonus")}get carryLimit(){return this.pokemon.carryLimit+5*Math.max(0,this.pokemon.evolutionCount)+this.ribbonCarryLimit+this.subSkills.getActiveSubSkills(this.level).reduce((e,t)=>e+t.inventory,0)*6}get ribbonCarryLimit(){switch(this.ribbon){case 1:return 1;case 2:return 3;case 3:return 6;case 4:return 8;default:return 0}}get form(){const e=this.pokemonName.match(/\(([^)]+)\)$/);if(e===null)return 0;switch(e[1]){case"Halloween":return 1;case"Holiday":return 2;case"Alola":return 3;case"Paldea":return 4;case"Amped":return 5;case"Low Key":return 6;case"Small":return 7;case"Medium":return 8;case"Large":return 9;case"Jumbo":return 10}return 0}static formToString(e){switch(e){case 1:return"Halloween";case 2:return"Holiday";case 3:return"Alola";case 4:return"Paldea";case 5:return"Amped";case 6:return"Low Key";case 7:return"Small";case 8:return"Medium";case 9:return"Large";case 10:return"Jumbo";default:return""}}get idForm(){return this.pokemon.id+(this.form<<12)}static getIdByIdForm(e){return e&4095}static getFormByIdForm(e){return e>>12}serialize(){const e=new Uint16Array(6);if(e[0]=1+(this.pokemon.id<<4),e[1]=this.form+(this.level<<6)+(ae.indexOf(this.ingredient)<<13),e[2]=(this.skillLevel-1<<2)+(k.allNatures.findIndex(n=>n.name===this.nature.name)<<6)+((this.subSkills.lv10===null?31:this.subSkills.lv10.index)<<11),e[3]=(this.subSkills.lv25===null?31:this.subSkills.lv25.index)+((this.subSkills.lv50===null?31:this.subSkills.lv50.index)<<5)+((this.subSkills.lv75===null?31:this.subSkills.lv75.index)<<10),e[4]=(this.subSkills.lv100===null?31:this.subSkills.lv100.index)+(this.ribbon<<5),this.pokemon.mythIng!==void 0){const n=this.pokemon.mythIng.findIndex(l=>l.name===this.mythIng1)+1,o=this.pokemon.mythIng.findIndex(l=>l.name===this.mythIng2)+1,s=this.pokemon.mythIng.findIndex(l=>l.name===this.mythIng3)+1,u=this.pokemon.mythIng.length+1;e[5]=n+o*u+s*u*u}const t=new Uint8Array(e.buffer);let i="";for(let n=0;n<t.length;n++)i+=String.fromCharCode(t[n]);return btoa(i).replace(/\//g,"-").substring(0,this.isMythical?16:12)}static deserialize(e){if(e.length===12)e=e.replace(/-/g,"/")+"AAAA";else if(e.length===16)e=e.replace(/-/g,"/");else throw new Error(`Invalid length ${e.length}`);const t=atob(e),i=new Uint8Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);const n=new Uint16Array(i.buffer);if((n[0]&15)!==1)throw new Error("Invalid version");const o=n[0]>>4;let s=N.find(a=>a.id===o);if(s===void 0)throw new Error(`Pokemon id ${o} not found`);const u=n[1]&63;if(u!==0){const a=V.formToString(u),v=`${s.name.replace(/ \(.+/,"")} (${a})`;if(s=N.find(S=>S.name===v),s===void 0)throw new Error(`Invalid form specified (${u})`)}const l=new V(s.name);if(l.level=n[1]>>6&127,l.level===0||l.level>100)throw new Error(`Invalid level (${l.level})`);const h=n[1]>>13&7;if(h>5)throw new Error(`Invalid ing value (${h})`);if(l.ingredient=ae[h],l.skillLevel=(n[2]>>2&7)+1,l.skillLevel>L(s.skill))throw new Error(`Too large skill level ${l.skillLevel} for ${s.name}`);const c=n[2]>>6&31;if(c>=k.allNatures.length)throw new Error(`Too large nature ${c}`);l.nature=k.allNatures[c];const p=C.allSubSkills,f=(a,v)=>{if(a===31)return null;if(a>=p.length)throw new Error(`Too large subskill for level ${v}: ${a}`);return p[a]};if(l.subSkills.lv10=f(n[2]>>11&31,10),l.subSkills.lv25=f(n[3]>>0&31,25),l.subSkills.lv50=f(n[3]>>5&31,50),l.subSkills.lv75=f(n[3]>>10&31,75),l.subSkills.lv100=f(n[4]>>0&31,100),l.ribbon=n[4]>>5&7,l.ribbon>=5)throw new Error(`Invalid ribbon (${l.ribbon})`);if(l.pokemon.mythIng!==void 0){const a=l.pokemon.mythIng.length+1,v=n[5]%a-1,S=Math.floor(n[5]/a)%a-1,d=Math.floor(n[5]/a/a)%a-1;l.mythIng1=v<0?"sausage":l.pokemon.mythIng[v].name,l.mythIng2=S<0?"unknown":l.pokemon.mythIng[S].name,l.mythIng3=d<0?"unknown":l.pokemon.mythIng[d].name}return l}}export{We as A,$e as M,k as N,V as P,re as S,C as a,he as b,Ge as c,L as d,q as e,De as f,pe as g,He as h,A as i,le as j,ne as k,Ke as l,je as m,ge as n,O as o,_e as p,Ee as q,Le as r,oe as s,Ie as t,Y as u,Ue as v,te as w,Oe as x,Ne as y,ze as z};
